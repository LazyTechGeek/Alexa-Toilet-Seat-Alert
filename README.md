Code I used for Alexa and Node-Red

"node-red-contrib-amazon-echo": https://flows.nodered.org/node/node-red-contrib-amazon-echo

Main Video "Home Assistant: Controlling Devices with Alexa": https://youtu.be/l1as3tYVy64

Basic On/Off Code


- **Full Code for Lighting**
```
[{"id":"ec40f4af5f19516e","type":"tab","label":"Toilet Seat (Zigbee)","disabled":false,"info":"","env":[]},{"id":"e4381e6c46100acb","type":"function","z":"ec40f4af5f19516e","name":"Bathroom Door is Closed","func":"flow.set (\"bathroom_door_open\",false);\nvar bathroom_door_open_status = flow.get (\"bathroom_door_open\");\nmsg.topic= bathroom_door_open_status;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":209.0994415283203,"y":178.2465991973877,"wires":[[]]},{"id":"0e087ff29e7966d1","type":"function","z":"ec40f4af5f19516e","name":"Bathroom Door is Open","func":"flow.set(\"bathroom_door_open\",true);\nvar bathroom_door_open_status = flow.get(\"bathroom_door_open\");\nmsg.topic = bathroom_door_open_status;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":209.0994415283203,"y":216.95177555084229,"wires":[[]]},{"id":"1142a0f7aea6301c","type":"function","z":"ec40f4af5f19516e","name":"Toilet Seat is Down","func":"flow.set (\"toilet_seat_up\",false);\nvar toilet_seat_up_status = flow.get (\"toilet_seat\");\nmsg.topic= toilet_seat_up_status;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":606.4435234069824,"y":183.84813563028968,"wires":[[]]},{"id":"8b53d6dbf882d507","type":"function","z":"ec40f4af5f19516e","name":"Toilet Seat is Up","func":"flow.set (\"toilet_seat_up\",true);\nvar toilet_seat_up_status = flow.get (\"toilet_seat\");\nmsg.topic= toilet_seat_up_status;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":371.2293014526367,"y":906.236668586731,"wires":[[]]},{"id":"4e259a54083692d3","type":"comment","z":"ec40f4af5f19516e","name":"Change Entity to Your Toilet Seat Sensor","info":"","x":676.4435234069824,"y":76.73544502258301,"wires":[]},{"id":"4ae6c238c9782ea4","type":"comment","z":"ec40f4af5f19516e","name":"Run when bathroom door opens","info":"","x":184.31948852539062,"y":1114.2576351165771,"wires":[]},{"id":"d0835b1ba723291d","type":"function","z":"ec40f4af5f19516e","name":"Get Toilet Seat Up Status","func":"var ObtainedData = flow.get (\"toilet_seat_up\");\nmsg.topic= ObtainedData;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":397.73639187812796,"y":1157.490240573883,"wires":[["8473b4fa378cfc11"]]},{"id":"8473b4fa378cfc11","type":"switch","z":"ec40f4af5f19516e","name":"If toilet Seat is Up","property":"topic","propertyType":"msg","rules":[{"t":"true"},{"t":"false"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":624.093986940384,"y":1164.990240573883,"wires":[["7eb23e63d0019538"],[],[]]},{"id":"7eb23e63d0019538","type":"function","z":"ec40f4af5f19516e","name":"Check if Nagging is Enabled","func":"var ObtainedData = flow.get (\"nagging_on\");\nmsg.topic= ObtainedData;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":860.45158200264,"y":1157.490240573883,"wires":[["aff6d5f65e071846"]]},{"id":"aff6d5f65e071846","type":"switch","z":"ec40f4af5f19516e","name":"If nagging_on_status is true","property":"topic","propertyType":"msg","rules":[{"t":"false"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1126.8091770648957,"y":1157.490240573883,"wires":[[],["16f300a8058ddfa9"]]},{"id":"df0f5211ddd6a0b7","type":"switch","z":"ec40f4af5f19516e","name":"If bathroom door is open","property":"topic","propertyType":"msg","rules":[{"t":"true"},{"t":"false"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":714.6466522216797,"y":1033.8475341796875,"wires":[["b61384901a3acfb6"],[],[]]},{"id":"f90c4cc15280bd98","type":"function","z":"ec40f4af5f19516e","name":"Check if Nagging is Enabled","func":"var ObtainedData = flow.get (\"nagging_on\");\nmsg.topic= ObtainedData;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1663.1016235351562,"y":1026.3475341796875,"wires":[["8428e3bf9a3c3d46"]]},{"id":"8428e3bf9a3c3d46","type":"switch","z":"ec40f4af5f19516e","name":"If nagging_on_status is true","property":"topic","propertyType":"msg","rules":[{"t":"false"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1929.2532806396484,"y":1026.3475341796875,"wires":[[],["98031e757d0c3fab"]]},{"id":"44947ef543b146bf","type":"function","z":"ec40f4af5f19516e","name":"Get toilet door open / closed status","func":"var ObtainedData = flow.get (\"bathroom_door_open\");\nmsg.topic= ObtainedData;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":438.4949951171875,"y":1026.3475341796875,"wires":[["df0f5211ddd6a0b7"]]},{"id":"af9f1ee85ab4c373","type":"comment","z":"ec40f4af5f19516e","name":"Run when toilet seat is down","info":"","x":160.15807342529297,"y":981.9508781433105,"wires":[]},{"id":"328df6cb2d91a4ca","type":"server-state-changed","z":"ec40f4af5f19516e","name":"Bathroom Door Status","server":"67fb9d0f.36c644","version":6,"outputs":2,"exposeAsEntityConfig":"","entities":{"entity":["binary_sensor.sensor_bathroom_door_contact"],"substring":[],"regex":[]},"outputInitially":false,"stateType":"str","ifState":"off","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":199.0994415283203,"y":124.45069980621338,"wires":[["e4381e6c46100acb"],["0e087ff29e7966d1","a6ca264065f4292d"]]},{"id":"89e6946684023fb5","type":"server-state-changed","z":"ec40f4af5f19516e","name":"Toilet Seat Status","server":"67fb9d0f.36c644","version":6,"outputs":2,"exposeAsEntityConfig":"","entities":{"entity":["binary_sensor.sensor_toilet_seat_contact"],"substring":[],"regex":[]},"outputInitially":false,"stateType":"str","ifState":"on","ifStateType":"str","ifStateOperator":"is","outputOnlyOnStateChange":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":596.4435234069824,"y":130.45083236694336,"wires":[["1142a0f7aea6301c","89067f657fcfcd6c"],["cf3bb10c426cc6c5"]]},{"id":"f13e602e6a395863","type":"function","z":"ec40f4af5f19516e","name":"Get Bathroom Door Open / Closed Status","func":"var ObtainedData = flow.get(\"bathroom_door_open\");\nmsg.topic= ObtainedData;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":448.92860412597656,"y":863.5379095077515,"wires":[["6f207bb0b994bd23"]]},{"id":"6f207bb0b994bd23","type":"switch","z":"ec40f4af5f19516e","name":"If bathroom door is open","property":"topic","propertyType":"msg","rules":[{"t":"true"},{"t":"false"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":748.1349487304688,"y":861.9506711959839,"wires":[["a73f24b4356ada7c"],["f74a6c6c7fa0098b"],["f74a6c6c7fa0098b"]]},{"id":"a73f24b4356ada7c","type":"function","z":"ec40f4af5f19516e","name":"set \"seat lifted_when door open\" to true","func":"flow.set (\"seat_lifted_when_door_open\",true);\nvar seat_lifted_when_door_open_status = flow.get (\"seat_lifted_when_door_open\");\nmsg.topic= seat_lifted_when_door_open_status;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1061.626937866211,"y":830.0459356307983,"wires":[[]]},{"id":"f74a6c6c7fa0098b","type":"function","z":"ec40f4af5f19516e","name":"set \"seat lifted_when door open\" to false","func":"flow.set (\"seat_lifted_when_door_open\",false);\nvar seat_lifted_when_door_open_status = flow.get (\"seat_lifted_when_door_open\");\nmsg.topic= seat_lifted_when_door_open_status;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1061.9443969726562,"y":883.220458984375,"wires":[[]]},{"id":"b61384901a3acfb6","type":"function","z":"ec40f4af5f19516e","name":"Get \"seat_lifted_when_door_open\" status","func":"var ObtainedData = flow.get (\"seat_lifted_when_door_open\");\nmsg.topic= ObtainedData;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1010.7983093261719,"y":1026.3475341796875,"wires":[["5cb1679cc0edd886"]]},{"id":"5cb1679cc0edd886","type":"switch","z":"ec40f4af5f19516e","name":"If \"seat_lifted_when_door_open\" is false","property":"seat_lifted_when_door_open","propertyType":"flow","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1356.949966430664,"y":1026.3475341796875,"wires":[[],["f90c4cc15280bd98"]]},{"id":"f28070739d0386de","type":"function","z":"ec40f4af5f19516e","name":"Random Nagging For Leaving Toilet Seat Up","func":"var line1 = [\n        \"Hey!, \",\n        \"Oi!, \",\n        \"Mate!, \",\n        \"Did I really just witness this?,\",\n        \"oh for crying out loud,\",\n        \"Excuse me, \"\n        ]\n        \nvar line2 = [\n        \"you've left the toilet seat up. \",\n        \"you didn't put the seat down. \",\n        \"the toilet seat is still up. \"\n        ]\n        \nvar line3 = [\n        \"go back and close it \",\n        \"Turn around and shut it! \",\n        \"close it now \"\n        ]\n        \nvar line4 = [\n        \"you \",\n        \"you \"\n        ]\n        \nvar line5 = [\n        \"dirty \",\n        \"lazy \",\n        \"disgusting \",\n        \"revolting \",\n        \"phile \",\n        \"despicable \",\n        \"pathetic\",\n        \"filthy \"\n        ]\n        \nvar line6 = [\n        \"git\",\n        \"walking embarrassment\",\n        \"individual\",\n        \"human\",\n        \"creature\",\n        \"animal\",\n        \"beast\",\n        \"excuse of a human being\",\n        \"slob \"\n        ]        \n\nmsg.payload =\n\nline1[Math.floor(Math.random() * line1.length)]+\nline2[Math.floor(Math.random() * line2.length)]+\nline3[Math.floor(Math.random() * line3.length)]+\nline4[Math.floor(Math.random() * line4.length)]+\nline5[Math.floor(Math.random() * line5.length)]+\nline6[Math.floor(Math.random() * line6.length)]\n\nreturn msg","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1993.83345413208,"y":468.4903202056885,"wires":[["aca94c16dd2f7cb2"]]},{"id":"27fa8d8cf8992afb","type":"alexa-remote-routine","z":"ec40f4af5f19516e","name":"Broadcast Announcement to Alexa Device","account":"d52478f1.087f58","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"msg","value":"payload"},"devices":["G0014C0594551CG2"]}},"x":1063.502082824707,"y":134.84744834899902,"wires":[[]]},{"id":"bd495c06692ef0e7","type":"function","z":"ec40f4af5f19516e","name":"Random Response after Closing Toilet Seat","func":"var line1 = [\n        \"Thankyou!, \",\n        \"Thanks, \",\n        \"good, \"\n        ]\nvar line2 = [\n        \"dont \",\n        \"you better not \"\n        ]\nvar line3 = [\n        \"make me \",\n        \"cause me to \",\n        \"make this a habbit and force me to \",\n        \"repeat this so that I have to \"\n        ]\nvar line4 = [\n        \"shout \",\n        \"complain \",\n        \"yell \"\n        ]\nvar line5 = [\n        \"again\",\n        \"once again\",\n        \"another time\"\n        ]        \n\nmsg.payload =\n\nline1[Math.floor(Math.random() * line1.length)]+\nline2[Math.floor(Math.random() * line2.length)]+\nline3[Math.floor(Math.random() * line3.length)]+\nline4[Math.floor(Math.random() * line4.length)]+\nline5[Math.floor(Math.random() * line4.length)]\n\nreturn msg","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":2017.5476722717285,"y":652.6332302093506,"wires":[["a3af1fdd7873d730"]]},{"id":"aefe1942e25733df","type":"delay","z":"ec40f4af5f19516e","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"outputs":1,"x":1738.2619895935059,"y":468.06179332733154,"wires":[["f28070739d0386de"]]},{"id":"3e0f4d9aa6b21b8a","type":"switch","z":"ec40f4af5f19516e","name":"Null?","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"undefined","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1638.3835716247559,"y":467.4787244796753,"wires":[["aefe1942e25733df"]],"l":false},{"id":"a46e993c92cb535f","type":"catch","z":"ec40f4af5f19516e","name":"Alexa errors","scope":["27fa8d8cf8992afb"],"uncaught":false,"x":1531.3834495544434,"y":467.58974742889404,"wires":[["3e0f4d9aa6b21b8a"]]},{"id":"5c6662da155eb028","type":"delay","z":"ec40f4af5f19516e","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"outputs":1,"x":1751.2619895935059,"y":653.0617933273315,"wires":[["bd495c06692ef0e7"]]},{"id":"cff1297141caf3d3","type":"switch","z":"ec40f4af5f19516e","name":"Null?","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"undefined","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1628.3835697174072,"y":653.4787034988403,"wires":[["5c6662da155eb028"]],"l":false},{"id":"04f753b8450b2abd","type":"catch","z":"ec40f4af5f19516e","name":"Alexa errors","scope":["e1dd64f4204d8773"],"uncaught":false,"x":1509.3834495544434,"y":654.589747428894,"wires":[["cff1297141caf3d3"]]},{"id":"02e5b92f970ea869","type":"link in","z":"ec40f4af5f19516e","name":"Link in_Post Toilet Seat Close Nag","links":["98031e757d0c3fab"],"x":1579.5476722717285,"y":705.6331691741943,"wires":[["bd495c06692ef0e7"]],"l":true},{"id":"98031e757d0c3fab","type":"link out","z":"ec40f4af5f19516e","name":"Link out","mode":"link","links":["02e5b92f970ea869"],"x":2135.4049377441406,"y":1026.3475341796875,"wires":[],"l":true},{"id":"4ca05e987f86ac73","type":"link in","z":"ec40f4af5f19516e","name":"Link in_Toilet Seat Up Nag","links":["16f300a8058ddfa9"],"x":1565.118984222412,"y":512.9188842773438,"wires":[["f28070739d0386de"]],"l":true},{"id":"16f300a8058ddfa9","type":"link out","z":"ec40f4af5f19516e","name":"Link out 2","mode":"link","links":["4ca05e987f86ac73"],"x":1333.1667721271515,"y":1157.490240573883,"wires":[],"l":true},{"id":"525027d1755b0bfc","type":"comment","z":"ec40f4af5f19516e","name":"Turn Nagging On / Off","info":"","x":140.98614764213562,"y":457.9383382797241,"wires":[]},{"id":"2340c5b36311b960","type":"inject","z":"ec40f4af5f19516e","name":"Nagging on","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":129.03970336914062,"y":502.8436117172241,"wires":[["17d5211e8de2900f"]]},{"id":"34566135cd580668","type":"inject","z":"ec40f4af5f19516e","name":"Nagging off","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":128.4047622680664,"y":552.9003467559814,"wires":[["c5ef3bcfcb3562ae"]]},{"id":"17d5211e8de2900f","type":"function","z":"ec40f4af5f19516e","name":"Turn on Nagging","func":"flow.set (\"nagging_on\",true);\nvar nagging_on_status = flow.get (\"nagging_on\");\nmsg.topic= nagging_on_status;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":309.94457244873047,"y":502.8436117172241,"wires":[["393629e467dbda2c"]]},{"id":"c5ef3bcfcb3562ae","type":"function","z":"ec40f4af5f19516e","name":"Turn off Nagging","func":"flow.set (\"nagging_on\",false);\nvar nagging_on_status = flow.get (\"nagging_on\");\nmsg.topic= nagging_on_status;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":309.62710189819336,"y":552.9003467559814,"wires":[["abe7502a14b0cbfa"]]},{"id":"889de33f6dbe98fb","type":"switch","z":"ec40f4af5f19516e","name":"Check if Nagging is Enabled","property":"topic","propertyType":"msg","rules":[{"t":"true"},{"t":"false"},{"t":"cont","v":"undefined","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":527.0968227386475,"y":695.9323263168335,"wires":[["25c9329a5ca1df40"],["414b1b7166c2cf37"],["da0a5e63119f6584"]]},{"id":"b8c29797f3a442ef","type":"function","z":"ec40f4af5f19516e","name":"Get Nagging Status","func":"var ObtainedData = flow.get (\"nagging_on\");\nmsg.topic= ObtainedData;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":289.7635555267334,"y":688.4324245452881,"wires":[["889de33f6dbe98fb"]]},{"id":"be9228894d26e7db","type":"inject","z":"ec40f4af5f19516e","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"check nagging status","payload":"","payloadType":"date","x":117.84915351867676,"y":688.4324245452881,"wires":[["b8c29797f3a442ef"]]},{"id":"accbf721edd790d2","type":"comment","z":"ec40f4af5f19516e","name":"Get Nagging Status","info":"","x":130.98614764213562,"y":642.1656303405762,"wires":[]},{"id":"978bbf60f2c041d8","type":"comment","z":"ec40f4af5f19516e","name":"NAG Toilet seat is up!","info":"","x":1559.412452697754,"y":420.8470678329468,"wires":[]},{"id":"af7880b98b74030b","type":"comment","z":"ec40f4af5f19516e","name":"POST NAG after closing toilet seat","info":"","x":1577.983814239502,"y":606.5613393783569,"wires":[]},{"id":"a6ca264065f4292d","type":"link out","z":"ec40f4af5f19516e","name":"If Bathroom Door Open","mode":"link","links":["22b1e7311035f6db"],"x":209.0994415283203,"y":255.65695190429688,"wires":[],"l":true},{"id":"22b1e7311035f6db","type":"link in","z":"ec40f4af5f19516e","name":"If Bathroom Door Open","links":["a6ca264065f4292d"],"x":161.3787968158722,"y":1157.490240573883,"wires":[["d0835b1ba723291d"]],"l":true},{"id":"564b06b82517632f","type":"link in","z":"ec40f4af5f19516e","name":"If Toilet Seat if Down (IN)","links":["89067f657fcfcd6c"],"x":162.3433380126953,"y":1026.3475341796875,"wires":[["44947ef543b146bf"]],"l":true},{"id":"89067f657fcfcd6c","type":"link out","z":"ec40f4af5f19516e","name":"If Toilet Seat if Down (OUT)","mode":"link","links":["564b06b82517632f"],"x":636.4435234069824,"y":220.3645270665487,"wires":[],"l":true},{"id":"cf3bb10c426cc6c5","type":"link out","z":"ec40f4af5f19516e","name":"If Toilet Seat is Up (OUT)","mode":"link","links":["88d2af1895f19ece"],"x":626.4435234069824,"y":256.8809185028076,"wires":[],"l":true},{"id":"88d2af1895f19ece","type":"link in","z":"ec40f4af5f19516e","name":"If Toilet Seat is Up (IN)","links":["cf3bb10c426cc6c5"],"x":152.91470336914062,"y":879.6826238632202,"wires":[["f13e602e6a395863","8b53d6dbf882d507"]],"l":true},{"id":"aca94c16dd2f7cb2","type":"link out","z":"ec40f4af5f19516e","name":"Broadcast Announcement to Alexa Device (OUT)","mode":"link","links":["e845c0502fcf77b7"],"x":2366.9898262023926,"y":470.1388626098633,"wires":[],"l":true},{"id":"e845c0502fcf77b7","type":"link in","z":"ec40f4af5f19516e","name":"Broadcast Announcement to Alexa Device (IN)","links":["aca94c16dd2f7cb2","a3af1fdd7873d730","0548710eb4ad4d35","d1c23f3d11e14a75"],"x":1073.502082824707,"y":237.02770900726318,"wires":[["056e4ea7769751bd"]],"l":true},{"id":"a3af1fdd7873d730","type":"link out","z":"ec40f4af5f19516e","name":"Broadcast Announcement to Alexa Device (OUT)","mode":"link","links":["e845c0502fcf77b7"],"x":2389.4086952209473,"y":653.7041606903076,"wires":[],"l":true},{"id":"27488e073178dca9","type":"comment","z":"ec40f4af5f19516e","name":"Change Entity to Your Bathroom Door Sensor","info":"","x":269.0994415283203,"y":76.73544502258301,"wires":[]},{"id":"6797e4369e68ccf1","type":"comment","z":"ec40f4af5f19516e","name":"Change Device to your Amazon Echo","info":"","x":1040.6448822021484,"y":76.73544502258301,"wires":[]},{"id":"f874a129f64ad75e","type":"comment","z":"ec40f4af5f19516e","name":"########### Do Not Edit the Below!!! ###########","info":"","x":674.0994644165039,"y":391.09375,"wires":[]},{"id":"79fed290d24195f5","type":"comment","z":"ec40f4af5f19516e","name":"This part prevents the routine from working if the bathroom door open","info":"","x":280.9861476421356,"y":814.2354001998901,"wires":[]},{"id":"393629e467dbda2c","type":"function","z":"ec40f4af5f19516e","name":"Nagging Enabled","func":"msg.payload = \"Nagging enabled\";\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":510.8494415283203,"y":502.8436117172241,"wires":[["0548710eb4ad4d35"]]},{"id":"0548710eb4ad4d35","type":"link out","z":"ec40f4af5f19516e","name":"Broadcast Announcement to Alexa Device (OUT)","mode":"link","links":["e845c0502fcf77b7"],"x":812.8494491577148,"y":526.5709056854248,"wires":[],"l":true},{"id":"abe7502a14b0cbfa","type":"function","z":"ec40f4af5f19516e","name":"Nagging Disabled","func":"msg.payload = \"Nagging disabled\";\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":510.8494415283203,"y":552.9003467559814,"wires":[["0548710eb4ad4d35"]]},{"id":"25c9329a5ca1df40","type":"function","z":"ec40f4af5f19516e","name":"Nagging Enabled","func":"msg.payload = \"Nagging enabled\";\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":776.8494663238525,"y":662.3887710571289,"wires":[["d1c23f3d11e14a75"]]},{"id":"d1c23f3d11e14a75","type":"link out","z":"ec40f4af5f19516e","name":"Broadcast Announcement to Alexa Device (OUT)","mode":"link","links":["e845c0502fcf77b7"],"x":1172.8494873046875,"y":695.3890190124512,"wires":[],"l":true},{"id":"414b1b7166c2cf37","type":"function","z":"ec40f4af5f19516e","name":"Nagging Disabled","func":"msg.payload = \"Nagging disabled\";\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":776.8494663238525,"y":697.3887701034546,"wires":[["d1c23f3d11e14a75"]]},{"id":"da0a5e63119f6584","type":"function","z":"ec40f4af5f19516e","name":"Undefined So Nagging is Enabled","func":"msg.payload = \"undefined so nagging is enabled\";\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":826.8494663238525,"y":733.3888912200928,"wires":[["d1c23f3d11e14a75"]]},{"id":"c147eb55be20b917","type":"comment","z":"ec40f4af5f19516e","name":"########### Do Not Edit the Below!!! ###########","info":"","x":1108.0994873046875,"y":391.09375,"wires":[]},{"id":"5dcf57ad537e0877","type":"comment","z":"ec40f4af5f19516e","name":"########### Do Not Edit the Below!!! ###########","info":"","x":240.0994415283203,"y":391.09375,"wires":[]},{"id":"056e4ea7769751bd","type":"delay","z":"ec40f4af5f19516e","name":"","pauseType":"delay","timeout":"1.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":973.502082824707,"y":184.70535373687744,"wires":[["27fa8d8cf8992afb"]]},{"id":"502b073c47e680ee","type":"function","z":"ec40f4af5f19516e","name":"Random Nagging For Leaving Toilet Seat Up","func":"var line1 = [\n        \"Hey!, \",\n        \"Oi!, \",\n        \"Mate!, \",\n        \"Did I really just witness this?,\",\n        \"oh for crying out loud,\",\n        \"Excuse me, \"\n        ]\n        \nvar line2 = [\n        \"you've left the toilet seat up. \",\n        \"you didn't put the seat down. \",\n        \"the toilet seat is still up. \"\n        ]\n        \nvar line3 = [\n        \"go back and close it \",\n        \"Turn around and shut it! \",\n        \"close it now \"\n        ]\n        \nvar line4 = [\n        \"you \",\n        \"you \"\n        ]\n        \nvar line5 = [\n        \"dirty \",\n        \"lazy \",\n        \"disgusting \",\n        \"revolting \",\n        \"phile \",\n        \"despicable \",\n        \"pathetic \",\n        \"filthy \"\n        ]\n        \nvar line6 = [\n        \"git\",\n        \"walking embarrassment\",\n        \"individual\",\n        \"human\",\n        \"creature\",\n        \"animal\",\n        \"beast\",\n        \"excuse of a human being\",\n        \"slob\"\n        ]        \n\nmsg.payload =\n\nline1[Math.floor(Math.random() * line1.length)]+\nline2[Math.floor(Math.random() * line2.length)]+\nline3[Math.floor(Math.random() * line3.length)]+\nline4[Math.floor(Math.random() * line4.length)]+\nline5[Math.floor(Math.random() * line5.length)]+\nline6[Math.floor(Math.random() * line6.length)]\n\nreturn msg","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1920.6613464355469,"y":842.9911060333252,"wires":[["f01830e598e438c1"]]},{"id":"0932b1258f6585da","type":"inject","z":"ec40f4af5f19516e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1645.0648612976072,"y":842.8226950422014,"wires":[["502b073c47e680ee"]]},{"id":"f01830e598e438c1","type":"debug","z":"ec40f4af5f19516e","name":"debug 7","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":2183.648654937744,"y":842.8145885467529,"wires":[]},{"id":"85d975fa8c144318","type":"comment","z":"ec40f4af5f19516e","name":"Example","info":"","x":1806.3758544921875,"y":787.2767944335938,"wires":[]},{"id":"67fb9d0f.36c644","type":"server","name":"Home Assistant","version":5,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":true,"cacheJson":true,"heartbeat":false,"heartbeatInterval":30,"areaSelector":"friendlyName","deviceSelector":"friendlyName","entitySelector":"friendlyName","statusSeparator":"at: ","statusYear":"hidden","statusMonth":"short","statusDay":"numeric","statusHourCycle":"h23","statusTimeFormat":"h:m","enableGlobalContextStore":true},{"id":"d52478f1.087f58","type":"alexa-remote-account","name":"","authMethod":"proxy","proxyOwnIp":"192.168.1.113","proxyPort":"3456","cookieFile":"/config/alexa_cookies12.txt","refreshInterval":"3","alexaServiceHost":"alexa.amazon.co.uk","amazonPage":"amazon.co.uk","acceptLanguage":"en-UK","userAgent":"","useWsMqtt":"on","autoInit":"on"}]
```
